<x-app-layout> <div class="py-12 bg-gray-50 min-h-screen"> <div class="max-w-7xl mx-auto sm:px-6 lg:px-8"> <!-- Header --> <div class="mb-6 bg-white shadow-sm p-6 border-l-4 border-primary-600"> <div class="flex items-center justify-between flex-wrap gap-4"> <div> <h1 class="text-3xl font-bold text-gray-900">ğŸ“Š Event Breakdown</h1> <p class="text-gray-600 mt-1">Overview of event bookings, attendance and revenue for {{ $year }}</p> </div> <div class="flex gap-2"> <a href="{{ route('admin.event-breakdown.index', ['year' => $year - 1]) }}" class="px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 font-semibold text-sm transition">â† {{ $year - 1 }}</a> <a href="{{ route('admin.event-breakdown.index', ['year' => now()->year]) }}" class="px-4 py-2 text-white font-semibold text-sm transition" style="background-color: #247a7c;">This Year</a> <a href="{{ route('admin.event-breakdown.index', ['year' => $year + 1]) }}" class="px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-700 font-semibold text-sm transition">{{ $year + 1 }} â†’</a> </div> </div> </div> <!-- Overview Stats --> <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 mb-6"> <div class="bg-white shadow-sm p-4 border-t-4 border-primary-600"> <div class="text-2xl font-bold text-gray-900">{{ $stats['total_events'] }}</div> <div class="text-xs text-gray-600 mt-1">Total Events</div> </div> <div class="bg-white shadow-sm p-4 border-t-4 border-blue-500"> <div class="text-2xl font-bold text-gray-900">{{ $stats['total_bookings'] }}</div> <div class="text-xs text-gray-600 mt-1">Total Bookings</div> </div> <div class="bg-white shadow-sm p-4 border-t-4 border-green-500"> <div class="text-2xl font-bold text-gray-900">{{ number_format($stats['total_attendees']) }}</div> <div class="text-xs text-gray-600 mt-1">Total Attendees</div> </div> <div class="bg-white shadow-sm p-4 border-t-4" style="border-color: #ae8800;"> <div class="text-2xl font-bold text-gray-900">Â£{{ number_format($stats['total_revenue'], 2) }}</div> <div class="text-xs text-gray-600 mt-1">Revenue</div> </div> <div class="bg-white shadow-sm p-4 border-t-4 border-indigo-500"> <div class="text-2xl font-bold text-gray-900">{{ number_format($stats['total_tickets']) }}</div> <div class="text-xs text-gray-600 mt-1">Tickets Issued</div> </div> <div class="bg-white shadow-sm p-4 border-t-4 border-red-400"> <div class="text-2xl font-bold text-gray-900">{{ $stats['total_cancelled'] }}</div> <div class="text-xs text-gray-600 mt-1">Cancellations</div> </div> </div> <!-- Ticket Type Breakdown --> <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6"> <div class="bg-white shadow-sm p-6"> <h3 class="text-lg font-bold text-gray-900 mb-4">Ticket Type Breakdown</h3> <table class="w-full text-sm"> <thead> <tr class="border-b border-gray-200"> <th class="text-left py-2 font-semibold text-gray-700">Type</th> <th class="text-right py-2 font-semibold text-gray-700">Count</th> <th class="text-right py-2 font-semibold text-gray-700">Revenue</th> </tr> </thead> <tbody> @foreach(['adult', 'child', 'concession'] as $type) <tr class="border-b border-gray-100"> <td class="py-2"> <span class="inline-flex items-center gap-2"> @if($type === 'adult') ğŸ‘¤ @elseif($type === 'child') ğŸ‘¶ @else â™¿ @endif {{ ucfirst($type) }} </span> </td> <td class="py-2 text-right font-medium">{{ number_format($ticketBreakdown[$type]->count ?? 0) }}</td> <td class="py-2 text-right font-medium">Â£{{ number_format($ticketBreakdown[$type]->revenue ?? 0, 2) }}</td> </tr> @endforeach </tbody> </table> </div> <!-- Monthly Events Chart --> <div class="bg-white shadow-sm p-6"> <h3 class="text-lg font-bold text-gray-900 mb-4">Events Per Month ({{ $year }})</h3> <div class="space-y-2"> @php $maxCount = max(1, max($monthlyCounts)); @endphp @foreach($monthlyCounts as $month => $count) <div class="flex items-center gap-3"> <div class="w-10 text-xs text-gray-600 font-medium text-right">{{ \Carbon\Carbon::create()->month($month)->format('M') }}</div> <div class="flex-1 bg-gray-100 h-6 overflow-hidden"> <div class="h-full flex items-center justify-end pr-2 text-xs font-bold text-white transition-all" style="width: {{ max(($count / $maxCount) * 100, $count > 0 ? 12 : 0) }}%; background-color: #247a7c;"> @if($count > 0) {{ $count }} @endif </div> </div> <div class="w-8 text-xs text-gray-500 text-right">{{ $count }}</div> </div> @endforeach </div> </div> </div> <!-- Filters --> <div class="bg-white shadow-sm p-6 mb-6"> <form method="GET" action="{{ route('admin.event-breakdown.index') }}" class="flex flex-col md:flex-row gap-4 items-end"> <input type="hidden" name="year" value="{{ $year }}"> <div class="flex-1"> <label class="block text-sm font-semibold text-gray-700 mb-1">Search Event</label> <input type="text" name="search" value="{{ $search }}" placeholder="Event name..." class="w-full border-gray-300 shadow-sm text-sm focus:border-primary-500 focus:ring-primary-500"> </div> <div class="w-full md:w-40"> <label class="block text-sm font-semibold text-gray-700 mb-1">Status</label> <select name="status" class="w-full border-gray-300 shadow-sm text-sm focus:border-primary-500 focus:ring-primary-500"> <option value="all" {{ $statusFilter === 'all' ? 'selected' : '' }}>All</option> <option value="active" {{ $statusFilter === 'active' ? 'selected' : '' }}>Active</option> <option value="cancelled" {{ $statusFilter === 'cancelled' ? 'selected' : '' }}>Cancelled</option> <option value="completed" {{ $statusFilter === 'completed' ? 'selected' : '' }}>Completed</option> </select> </div> <div class="w-full md:w-40"> <label class="block text-sm font-semibold text-gray-700 mb-1">Month</label> <select name="month" class="w-full border-gray-300 shadow-sm text-sm focus:border-primary-500 focus:ring-primary-500"> <option value="">All Months</option> @for($m = 1; $m <= 12; $m++) <option value="{{ $m }}" {{ (int)$monthFilter === $m ? 'selected' : '' }}>{{ \Carbon\Carbon::create()->month($m)->format('F') }}</option> @endfor </select> </div> <div class="flex gap-2"> <button type="submit" class="px-5 py-2.5 text-white font-semibold text-sm transition" style="background-color: #247a7c;">Filter</button> @if($search || $statusFilter !== 'all' || $monthFilter) <a href="{{ route('admin.event-breakdown.index', ['year' => $year]) }}" class="px-5 py-2.5 bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold text-sm transition">Clear</a> @endif </div> </form> </div> <!-- Events Table --> <div class="bg-white shadow-sm overflow-hidden"> <div class="p-6 border-b border-gray-200"> <h3 class="text-lg font-bold text-gray-900">All Events</h3> </div> <div class="overflow-x-auto"> <table class="w-full text-sm"> <thead class="bg-gray-50 border-b border-gray-200"> <tr> <th class="px-4 py-3 text-left font-semibold text-gray-700">Event</th> <th class="px-4 py-3 text-left font-semibold text-gray-700">Date</th> <th class="px-4 py-3 text-left font-semibold text-gray-700">Location</th> <th class="px-4 py-3 text-center font-semibold text-gray-700">Bookings</th> <th class="px-4 py-3 text-center font-semibold text-gray-700">Attendees</th> <th class="px-4 py-3 text-center font-semibold text-gray-700">Capacity</th> <th class="px-4 py-3 text-center font-semibold text-gray-700">Occupancy</th> <th class="px-4 py-3 text-right font-semibold text-gray-700">Revenue</th> <th class="px-4 py-3 text-center font-semibold text-gray-700">Status</th> <th class="px-4 py-3 text-center font-semibold text-gray-700"></th> </tr> </thead> <tbody class="divide-y divide-gray-200"> @forelse($events as $event) @php $attendees = $event->confirmed_bookings_sum_total_tickets ?? 0; $occupancy = $event->capacity > 0 ? round(($attendees / $event->capacity) * 100) : 0; @endphp <tr class="hover:bg-gray-50 transition"> <td class="px-4 py-3"> <span class="font-semibold text-gray-900">{{ $event->title }}</span> </td> <td class="px-4 py-3 text-gray-600 whitespace-nowrap"> {{ $event->start_datetime->format('M d, Y') }}<br> <span class="text-xs text-gray-400">{{ $event->start_datetime->format('g:i A') }}</span> </td> <td class="px-4 py-3 text-gray-600">{{ $event->location->name ?? 'TBA' }}</td> <td class="px-4 py-3 text-center font-bold text-gray-900">{{ $event->confirmed_bookings_count }}</td> <td class="px-4 py-3 text-center font-bold text-gray-900">{{ number_format($attendees) }}</td> <td class="px-4 py-3 text-center text-gray-600">{{ $event->capacity }}</td> <td class="px-4 py-3 text-center"> <div class="flex items-center justify-center gap-2"> <div class="w-16 bg-gray-200 h-2 overflow-hidden"> <div class="h-full" style="width: {{ min($occupancy, 100) }}%; background-color: {{ $occupancy >= 90 ? '#ef4444' : ($occupancy >= 60 ? '#ae8800' : '#247a7c') }};"></div> </div> <span class="text-xs font-medium {{ $occupancy >= 90 ? 'text-red-600' : 'text-gray-600' }}">{{ $occupancy }}%</span> </div> </td> <td class="px-4 py-3 text-right font-medium text-gray-900">Â£{{ number_format($event->confirmed_bookings_sum_total_amount ?? 0, 2) }}</td> <td class="px-4 py-3 text-center"> @if($event->status === 'active') <span class="inline-flex items-center px-2 py-0.5 text-xs font-medium bg-green-100 text-green-800">Active</span> @elseif($event->status === 'cancelled') <span class="inline-flex items-center px-2 py-0.5 text-xs font-medium bg-red-100 text-red-800">Cancelled</span> @else <span class="inline-flex items-center px-2 py-0.5 text-xs font-medium bg-gray-100 text-gray-800">{{ ucfirst($event->status) }}</span> @endif </td> <td class="px-4 py-3 text-center"> <a href="{{ route('admin.event-breakdown.show', $event) }}" class="text-sm font-semibold transition" style="color: #247a7c;">View â†’</a> </td> </tr> @empty <tr> <td colspan="10" class="px-4 py-8 text-center text-gray-500">No events found matching your filters.</td> </tr> @endforelse </tbody> </table> </div> @if($events->hasPages()) <div class="p-4 border-t border-gray-200"> {{ $events->links() }} </div> @endif </div> </div> </div>
</x-app-layout>

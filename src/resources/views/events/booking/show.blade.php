<x-layouts.app> <div class="min-h-screen bg-gray-50"> <!-- Header Section with Event Title --> <div class="bg-gradient-to-r from-primary-400 to-teal-light-400 text-white py-8"> <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8"> <a href="{{ route('events.show', $event->id) }}" class="inline-flex items-center text-white/80 hover:text-white mb-4 transition"> <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/> </svg> Back to Event </a> <h1 class="text-4xl md:text-5xl font-bold mb-2">{{ $event->title }}</h1> <p class="text-xl text-white/90">Complete your booking</p> </div> </div> <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8"> <!-- Alert Messages --> @if ($errors->any()) <div class="mb-6 bg-red-50 border-l-4 border-red-500 p-4 -r"> <div class="flex"> <svg class="w-6 h-6 text-red-500 mr-3 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/> </svg> <div> <h3 class="font-bold text-red-800 mb-1">Unable to complete booking</h3> <ul class="text-red-700 list-disc list-inside"> @foreach ($errors->all() as $error) <li>{{ $error }}</li> @endforeach </ul> </div> </div> </div> @endif <!-- Event is Cancelled --> @if ($event->is_cancelled) <div class="bg-white shadow-lg p-8 text-center"> <svg class="w-20 h-20 text-red-500 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/> </svg> <h2 class="text-3xl font-bold text-gray-900 mb-2">Event Cancelled</h2> <p class="text-gray-600 text-lg">This event is no longer available for booking.</p> </div> @elseif ($event->is_fully_booked) <!-- Event is Full --> <div class="bg-white shadow-lg p-8 text-center"> <svg class="w-20 h-20 text-gray-400 mx-auto mb-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/> </svg> <h2 class="text-3xl font-bold text-gray-900 mb-2">Fully Booked</h2> <p class="text-gray-600 text-lg mb-6">Unfortunately, this event has reached full capacity.</p> <a href="{{ route('events') }}" class="inline-block bg-teal-light-400 hover:bg-primary-700 text-white px-8 py-3 font-semibold transition"> Browse Other Events </a> </div> @else <!-- Booking Form --> <div class="grid md:grid-cols-3 gap-6"> <!-- Left Column: Event Details --> <div class="md:col-span-1 space-y-6"> <!-- Event Image --> @if ($event->primary_image) <div class="bg-white shadow-lg overflow-hidden"> <img src="{{ asset('storage/' . $event->primary_image) }}" alt="{{ $event->title }}" class="w-full h-48 object-cover"> </div> @endif <!-- Event Info Card --> <div class="bg-white shadow-lg p-6 space-y-4"> <h3 class="text-lg font-bold text-gray-900 border-b pb-2">Event Details</h3> <!-- Date & Time --> <div class="flex items-start"> <svg class="w-5 h-5 text-primary-600 mr-3 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"/> </svg> <div> <p class="font-semibold text-gray-900">{{ $event->start_datetime->format('l, j F Y') }}</p> <p class="text-gray-600 text-sm">{{ $event->start_datetime->format('g:i A') }} - {{ $event->end_datetime->format('g:i A') }}</p> <p class="text-gray-500 text-sm">Duration: {{ $event->duration_minutes }} minutes</p> </div> </div> <!-- Location --> <div class="flex items-start"> <svg class="w-5 h-5 text-primary-600 mr-3 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"/> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"/> </svg> <div> <p class="font-semibold text-gray-900">{{ $event->location->name }}</p> <p class="text-gray-600 text-sm">{{ $event->location->address }}</p> </div> </div> <!-- Capacity --> <div class="flex items-start"> <svg class="w-5 h-5 text-primary-600 mr-3 mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"/> </svg> <div> <p class="font-semibold text-gray-900"> <span class="text-secondary-600">{{ $event->remaining_spaces }}</span> spaces remaining </p> <p class="text-gray-500 text-sm">of {{ $event->capacity }} total capacity</p> </div> </div> </div> <!-- Cancellation Policy --> <div class="bg-blue-50 p-4 text-sm"> <h4 class="font-bold text-gray-900 mb-2">Cancellation Policy</h4> <ul class="text-gray-700 space-y-1"> <li>• Cancel more than 24h before: 100% refund</li> <li>• Cancel within 24h: 50% refund</li> <li>• No rescheduling available</li> </ul> </div> </div> <!-- Right Column: Booking Form --> <div class="md:col-span-2"> <form method="POST" action="{{ route('events.book.store', $event->id) }}" class="bg-white shadow-lg p-6 md:p-8 space-y-6"> @csrf <!-- Ticket Selection --> <div> <h3 class="text-2xl font-bold text-gray-900 mb-1">Select Tickets</h3> <p class="text-gray-600 mb-6">Maximum 4 tickets per booking</p> <div class="space-y-4"> <!-- Adult Tickets --> <div class="flex items-center justify-between p-4 border-2 border-gray-200 hover:border-primary-300 transition"> <div class="flex-1"> <label class="font-semibold text-gray-900 text-lg block">Adult</label> @if ($event->is_paid) <span class="text-primary-600 font-bold">£{{ number_format($event->adult_price, 2) }}</span> @else <span class="text-green-600 font-semibold">Free</span> @endif </div> <div class="flex items-center space-x-3"> <button type="button" onclick="decrementTicket('adult')" class="w-10 h-10 border-2 border-gray-300 hover:border-primary-600 hover:bg-primary-50 flex items-center justify-center font-bold text-xl transition"> − </button> <input type="number" name="adult_tickets" id="adult_tickets" value="{{ old('adult_tickets', 0) }}" min="0" max="4" class="w-16 h-10 text-center text-xl font-bold border-2 border-gray-300 focus:border-primary-600 focus:ring-2 focus:ring-primary-200" onchange="updateTotal()" readonly> <button type="button" onclick="incrementTicket('adult')" class="w-10 h-10 border-2 border-gray-300 hover:border-primary-600 hover:bg-primary-50 flex items-center justify-center font-bold text-xl transition"> + </button> </div> </div> <!-- Child Tickets --> <div class="flex items-center justify-between p-4 border-2 border-gray-200 hover:border-primary-300 transition"> <div class="flex-1"> <label class="font-semibold text-gray-900 text-lg block">Child</label> @if ($event->is_paid) <span class="text-primary-600 font-bold">£{{ number_format($event->child_price, 2) }}</span> @else <span class="text-green-600 font-semibold">Free</span> @endif </div> <div class="flex items-center space-x-3"> <button type="button" onclick="decrementTicket('child')" class="w-10 h-10 border-2 border-gray-300 hover:border-primary-600 hover:bg-primary-50 flex items-center justify-center font-bold text-xl transition"> − </button> <input type="number" name="child_tickets" id="child_tickets" value="{{ old('child_tickets', 0) }}" min="0" max="4" class="w-16 h-10 text-center text-xl font-bold border-2 border-gray-300 focus:border-primary-600 focus:ring-2 focus:ring-primary-200" onchange="updateTotal()" readonly> <button type="button" onclick="incrementTicket('child')" class="w-10 h-10 border-2 border-gray-300 hover:border-primary-600 hover:bg-primary-50 flex items-center justify-center font-bold text-xl transition"> + </button> </div> </div> <!-- Concession Tickets --> <div class="flex items-center justify-between p-4 border-2 border-gray-200 hover:border-primary-300 transition"> <div class="flex-1"> <label class="font-semibold text-gray-900 text-lg block">Concession</label> @if ($event->is_paid) <span class="text-primary-600 font-bold">£{{ number_format($event->concession_price, 2) }}</span> @else <span class="text-green-600 font-semibold">Free</span> @endif </div> <div class="flex items-center space-x-3"> <button type="button" onclick="decrementTicket('concession')" class="w-10 h-10 border-2 border-gray-300 hover:border-primary-600 hover:bg-primary-50 flex items-center justify-center font-bold text-xl transition"> − </button> <input type="number" name="concession_tickets" id="concession_tickets" value="{{ old('concession_tickets', 0) }}" min="0" max="4" class="w-16 h-10 text-center text-xl font-bold border-2 border-gray-300 focus:border-primary-600 focus:ring-2 focus:ring-primary-200" onchange="updateTotal()" readonly> <button type="button" onclick="incrementTicket('concession')" class="w-10 h-10 border-2 border-gray-300 hover:border-primary-600 hover:bg-primary-50 flex items-center justify-center font-bold text-xl transition"> + </button> </div> </div> </div> <!-- Total Display --> <div class="mt-6 p-4 bg-gradient-to-r from-teal-light-50 to-teal-light-100 border-2 border-teal-light-300"> <div class="flex justify-between items-center"> <span class="text-lg font-semibold text-gray-900">Total Tickets:</span> <span id="total_tickets" class="text-2xl font-bold text-teal-light-500">0</span> </div> @if ($event->is_paid) <div class="flex justify-between items-center mt-2 pt-2 border-t border-teal-light-300"> <span class="text-lg font-semibold text-gray-900">Total Amount:</span> <span id="total_amount" class="text-2xl font-bold text-teal-light-500">£0.00</span> </div> @endif </div> </div> <!-- Personal Information --> <div class="border-t pt-6"> <h3 class="text-2xl font-bold text-gray-900 mb-6">Your Information</h3> @guest <!-- Guest Booking Fields --> <div class="bg-teal-light-50 border-2 border-teal-light-300 p-6 mb-4"> <div class="flex items-center mb-4"> <svg class="w-6 h-6 text-teal-light-500 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/> </svg> <h4 class="font-bold text-gray-900 text-lg">Book as Guest</h4> </div> <p class="text-gray-600 text-sm mb-4">No account needed! Just provide your details below.</p> </div> <div class="space-y-4"> <div class="grid grid-cols-1 sm:grid-cols-2 gap-4"> <div> <label for="guest_first_name" class="block font-semibold text-gray-900 mb-2 text-lg">First Name *</label> <input type="text" name="guest_first_name" id="guest_first_name" value="{{ old('guest_first_name') }}" required class="w-full px-4 py-3 text-lg border-2 border-gray-300 focus:border-teal-light-500 focus:ring-2 focus:ring-teal-light-200" placeholder="John"> @error('guest_first_name') <p class="text-red-600 text-sm mt-1">{{ $message }}</p> @enderror </div> <div> <label for="guest_surname" class="block font-semibold text-gray-900 mb-2 text-lg">Surname *</label> <input type="text" name="guest_surname" id="guest_surname" value="{{ old('guest_surname') }}" required class="w-full px-4 py-3 text-lg border-2 border-gray-300 focus:border-teal-light-500 focus:ring-2 focus:ring-teal-light-200" placeholder="Smith"> @error('guest_surname') <p class="text-red-600 text-sm mt-1">{{ $message }}</p> @enderror </div> </div> <div> <label for="guest_email" class="block font-semibold text-gray-900 mb-2 text-lg">Email Address *</label> <input type="email" name="guest_email" id="guest_email" value="{{ old('guest_email') }}" required class="w-full px-4 py-3 text-lg border-2 border-gray-300 focus:border-teal-light-500 focus:ring-2 focus:ring-teal-light-200" placeholder="john.smith@example.com"> <p class="text-sm text-gray-600 mt-1">Booking confirmation will be sent here</p> @error('guest_email') <p class="text-red-600 text-sm mt-1">{{ $message }}</p> @enderror </div> </div> @else <!-- Logged-in User Info --> <div class="bg-gray-50 p-4 space-y-2"> <p class="text-gray-700"><span class="font-semibold">Name:</span> {{ Auth::user()->name }}</p> <p class="text-gray-700"><span class="font-semibold">Email:</span> {{ Auth::user()->email }}</p> </div> @endguest </div> <!-- Accessibility Notes --> <div> <label for="accessibility_notes" class="block font-semibold text-gray-900 mb-2 text-lg"> Accessibility or Special Requirements <span class="text-gray-500 font-normal text-sm">(Optional)</span> </label> <textarea name="accessibility_notes" id="accessibility_notes" rows="3" class="w-full px-4 py-3 border-2 border-gray-300 focus:border-teal-light-500 focus:ring-2 focus:ring-teal-light-200" placeholder="Please let us know about any mobility, sensory, or other accessibility needs...">{{ old('accessibility_notes') }}</textarea> <p class="text-sm text-gray-600 mt-1">Help us make your visit comfortable</p> </div> <!-- Newsletter Opt-in --> <div class="flex items-start"> <input type="checkbox" name="newsletter_opt_in" id="newsletter_opt_in" value="1" {{ old('newsletter_opt_in') ? 'checked' : '' }} class="w-5 h-5 text-teal-light-500 border-gray-300 focus:ring-teal-light-400 mt-1"> <label for="newsletter_opt_in" class="ml-3 text-gray-700"> <span class="font-semibold">Keep me updated</span><br> <span class="text-sm">Receive newsletters about upcoming events and news from Delapré Abbey</span> </label> </div> <!-- reCAPTCHA --> <div class="flex justify-center"> <div class="g-recaptcha" data-sitekey="{{ config('services.recaptcha.site_key') }}"></div> </div> @error('g-recaptcha-response') <p class="text-red-600 text-sm mt-2 text-center">{{ $message }}</p> @enderror <!-- Submit Button --> <div class="flex flex-col sm:flex-row gap-4 pt-6"> <div class="flex-1 flex flex-col items-center gap-2"> <button type="submit" class="w-full bg-teal-light-400 hover:bg-primary-700 text-white font-bold py-4 px-8 text-xl shadow-lg hover:shadow-xl transition transform hover:-translate-y-0.5"> @if ($event->is_paid) Continue to Payment @else Confirm Booking @endif </button> @if ($event->is_paid) <div class="flex items-center gap-1.5 text-xs text-gray-500"> <span>Powered by</span> <svg class="h-3" viewBox="0 0 60 25" fill="#635bff" xmlns="http://www.w3.org/2000/svg"> <path d="M59.64 14.28h-8.06c.19 1.93 1.6 2.55 3.2 2.55 1.64 0 2.96-.37 4.05-.95v3.32a8.33 8.33 0 0 1-4.56 1.1c-4.01 0-6.83-2.5-6.83-7.48 0-4.19 2.39-7.52 6.3-7.52 3.92 0 5.96 3.28 5.96 7.5 0 .4-.04 1.26-.06 1.48zm-5.92-5.62c-1.03 0-2.17.73-2.17 2.58h4.25c0-1.85-1.07-2.58-2.08-2.58zM40.95 20.3c-1.44 0-2.32-.6-2.9-1.04l-.02 4.63-4.12.87V5.57h3.76l.08 1.02a4.7 4.7 0 0 1 3.23-1.29c2.9 0 5.62 2.6 5.62 7.4 0 5.23-2.7 7.6-5.65 7.6zM40 8.95c-.95 0-1.54.34-1.97.81l.02 6.12c.4.44.98.78 1.95.78 1.52 0 2.54-1.65 2.54-3.87 0-2.15-1.04-3.84-2.54-3.84zM28.24 5.57h4.13v14.44h-4.13V5.57zm0-4.7L32.37 0v3.36l-4.13.88V.88zm-4.32 9.35v9.79H19.8V5.57h3.7l.12 1.22c1-1.77 3.07-1.41 3.62-1.22v3.79c-.52-.17-2.29-.43-3.32.86zm-8.55 4.72c0 2.43 2.6 1.68 3.12 1.46v3.36c-.55.3-1.54.54-2.89.54a4.15 4.15 0 0 1-4.27-4.24l.01-13.17 4.02-.86v3.54h3.14V9.1h-3.13v5.85zm-4.91.7c0 2.97-2.31 4.66-5.73 4.66a11.2 11.2 0 0 1-4.46-.93v-3.93c1.38.75 3.1 1.31 4.46 1.31.92 0 1.53-.24 1.53-1C6.26 13.77 0 14.51 0 9.95 0 7.04 2.28 5.3 5.62 5.3c1.36 0 2.72.2 4.09.75v3.88a9.23 9.23 0 0 0-4.1-1.06c-.86 0-1.44.25-1.44.9 0 1.85 6.29.97 6.29 5.88z"/> </svg> </div> @endif </div> <a href="{{ route('events.show', $event->id) }}" class="text-center border-2 border-gray-300 hover:border-gray-400 text-gray-700 font-bold py-4 px-8 text-xl transition"> Cancel </a> </div> @if ($event->is_paid) <p class="text-sm text-gray-600 text-center"> <svg class="w-4 h-4 inline mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24"> <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/> </svg> Secure payment processing </p> @endif </form> </div> </div> @endif </div> </div> <!-- Ticket Selection Script --> <script> const maxTickets = 4; const remainingSpaces = {{ $event->remaining_spaces }}; const prices = { adult: {{ $event->adult_price ?? 0 }}, child: {{ $event->child_price ?? 0 }}, concession: {{ $event->concession_price ?? 0 }} }; const isPaid = {{ $event->is_paid ? 'true' : 'false' }}; function incrementTicket(type) { const input = document.getElementById(type + '_tickets'); const currentValue = parseInt(input.value); const totalTickets = getTotalTickets(); if (totalTickets < maxTickets && totalTickets < remainingSpaces) { input.value = currentValue + 1; updateTotal(); } else if (totalTickets >= maxTickets) { alert('Maximum 4 tickets per booking'); } else { alert('Not enough spaces available'); } } function decrementTicket(type) { const input = document.getElementById(type + '_tickets'); const currentValue = parseInt(input.value); if (currentValue > 0) { input.value = currentValue - 1; updateTotal(); } } function getTotalTickets() { const adult = parseInt(document.getElementById('adult_tickets').value) || 0; const child = parseInt(document.getElementById('child_tickets').value) || 0; const concession = parseInt(document.getElementById('concession_tickets').value) || 0; return adult + child + concession; } function updateTotal() { const adult = parseInt(document.getElementById('adult_tickets').value) || 0; const child = parseInt(document.getElementById('child_tickets').value) || 0; const concession = parseInt(document.getElementById('concession_tickets').value) || 0; const totalTickets = adult + child + concession; document.getElementById('total_tickets').textContent = totalTickets; if (isPaid) { const totalAmount = (adult * prices.adult) + (child * prices.child) + (concession * prices.concession); document.getElementById('total_amount').textContent = '£' + totalAmount.toFixed(2); } } // Initialize on page load updateTotal(); </script> <!-- Google reCAPTCHA --> <script src="https://www.google.com/recaptcha/api.js" async defer></script>
</x-layouts.app>
